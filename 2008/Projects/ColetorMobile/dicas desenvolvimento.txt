Passos Piking Mobile : 

Carregar dados da proposta: TOP 1

codigoPROPOSTA;
ClientePROPOSTA;
numeroPROPOSTA, 
dataLIBERACAOPROPOSTA
razaoEMPRESA
ordemseparacaoimpressaPROPOSTA
//observacaoPROPOSTA

Produto:

PARTNUMBER: 
DESCRICAO:
LOTE:
QUANTIDADE:
KPATH:

CREATE VIEW vwMobile_tb1601_Proposta

AS

SELECT  TOP 1 codigoPROPOSTA,numeroPROPOSTA, CONVERT(nvarchar, P.dataLIBERACAOPROPOSTA,103)  +' '+ CONVERT(nvarchar, P.dataLIBERACAOPROPOSTA,108) as dataLIBERACAOPROPOSTA,clientePROPOSTA AS clientePROPOSTA, razaoEMPRESA ,
COALESCE(ordemseparacaoimpressaPROPOSTA,0) AS ordemseparacaoimpressaPROPOSTA
FROM tb1601_Propostas (NOLOCK) 
INNER JOIN tb1611_Liberacoes_Proposta P (NOLOCK) ON P.propostaLIBERACAOPROPOSTA = codigoPROPOSTA 
INNER JOIN tb1611_Liberacoes_Proposta C (NOLOCK) ON C.propostaLIBERACAOPROPOSTA = codigoPROPOSTA 
INNER JOIN tb0301_Empresas (NOLOCK) ON clientePROPOSTA = codigoEMPRESA 
WHERE statusPROPOSTA = 1 AND P.liberacaoLIBERACAOPROPOSTA = 1 AND C.liberacaoLIBERACAOPROPOSTA = 2 
                         AND P.liberadoLIBERACAOPROPOSTA = 1  AND C.liberadoLIBERACAOPROPOSTA = 0
						 ORDER BY  P.dataLIBERACAOPROPOSTA ASC

						 
						 ITENS PROPOSTA 
						 
	Recupera o c√≥digo da proposta trabalhada
	trabalhar com o numero da proposta.
	
	
	
	SELECT produtoRESERVA AS PRODUTO,  SUM(quantidadeRESERVA) AS QTD FROM tb1206_Reservas (NOLOCK)  INNER JOIN tb1602_Itens_Proposta (NOLOCK) ON codigoITEMPROPOSTA = docRESERVA WHERE propostaITEMPROPOSTA = 78527 AND tipodocRESERVA = 1602 AND statusITEMPROPOSTA = 3 AND separadoITEMPROPOSTA = 0 GROUP BY produtoRESERVA
	
	
	SELECT nomePRODUTO,partnumberPRODUTO,produtoRESERVA AS PRODUTO,  SUM(quantidadeRESERVA) AS QTD  FROM tb1206_Reservas (NOLOCK) INNER JOIN tb1602_Itens_Proposta (NOLOCK) ON codigoITEMPROPOSTA = docRESERVA INNER JOIN tb0501_Produtos (NOLOCK) ON produtoITEMPROPOSTA = codigoPRODUTO WHERE propostaITEMPROPOSTA = 78527 AND tipodocRESERVA = 1602  AND statusITEMPROPOSTA = 3 AND separadoITEMPROPOSTA = 0 GROUP BY produtoRESERVA,produtoITEMPROPOSTA,nomePRODUTO,partnumberPRODUTO

	
	SELECT nomePRODUTO,partnumberPRODUTO,produtoRESERVA AS PRODUTO,  SUM(quantidadeRESERVA) AS QTD  
FROM tb1206_Reservas (NOLOCK) INNER JOIN tb1602_Itens_Proposta (NOLOCK) ON codigoITEMPROPOSTA = docRESERVA 
INNER JOIN tb0501_Produtos (NOLOCK) ON produtoITEMPROPOSTA = codigoPRODUTO 
WHERE propostaITEMPROPOSTA = 78527 AND tipodocRESERVA = 1602  AND statusITEMPROPOSTA = 3 AND separadoITEMPROPOSTA = 0 
GROUP BY produtoRESERVA,produtoITEMPROPOSTA,nomePRODUTO,partnumberPRODUTO



    Public Sub preencheComboBox(ByVal cb As ComboBox, ByVal sql01 As String, ByVal dt As DataTable, ByVal columnName As String)

        ''preenche um DataTable
        clsSqlConn.fillDataTable(dt, sql01)

        Dim dr As DataRow

        With cb
            .Items.Clear()
            .DropDownStyle = ComboBoxStyle.DropDownList
            .DisplayMember = columnName
            .ValueMember = columnName
        End With

        For Each dr In dt.Rows()
            cb.Items.Add(dr.Item(columnName).ToString)
        Next

    End Sub


    Public Sub DisplayAll(ByVal obj As Object)
        Dim _type As Type = obj.GetType()
        Dim properties() As PropertyInfo = _type.GetProperties()  'line 3
        For Each _property As PropertyInfo In properties
            Console.WriteLine("Name: " + _property.Name)
        Next
    End Sub

    Public Sub validaComboBox(ByVal cb As ComboBox, ByVal control As Control, ByVal eKey As KeyEventArgs)

        If Not (cb.Text Is Nothing) Then
            Select Case eKey.KeyValue
                Case Keys.Enter
                    If (cb.SelectedItem <> Nothing) Then
                        If (cb.Items.IndexOf(cb.Text) <> -1) Then
                            control.Text = Nothing
                            control.Enabled = True
                            control.Focus()
                        Else
                            control.Text = Nothing
                            control.Enabled = False
                            cb.Focus()
                        End If
                    Else
                        control.Enabled = False
                        cb.Focus()
                    End If
                Case Keys.Delete
                Case Keys.Back
                    cb.Text = Nothing
            End Select
        End If
		


		
		SELECT codigoITEMPROPOSTA,propostaITEMPROPOSTA,produtoRESERVA AS codigoPRODUTO,nomePRODUTO,partnumberPRODUTO,ean13PRODUTO,SUM(quantidadeRESERVA) AS QTD 
,loteRESERVA,localLOTELOCAL,nomeLOCAL
FROM tb1206_Reservas (NOLOCK) 
INNER JOIN tb1602_Itens_Proposta (NOLOCK) ON codigoITEMPROPOSTA = docRESERVA 
INNER JOIN tb0501_Produtos (NOLOCK) ON produtoITEMPROPOSTA = codigoPRODUTO
INNER JOIN tb1212_Lotes_Locais (NOLOCK) ON loteRESERVA = loteLOTELOCAL
INNER JOIN tb1211_Locais ON codigoLOCAL = localLOTELOCAL
WHERE propostaITEMPROPOSTA = 75899
AND tipodocRESERVA = 1602 
AND statusITEMPROPOSTA = 3 
AND separadoITEMPROPOSTA = 0  
GROUP BY codigoITEMPROPOSTA,propostaITEMPROPOSTA,ean13PRODUTO,produtoRESERVA,produtoITEMPROPOSTA,nomePRODUTO,
         partnumberPRODUTO,loteRESERVA,localLOTELOCAL,nomeLOCAL
ORDER BY nomeLOCAL ASC


	